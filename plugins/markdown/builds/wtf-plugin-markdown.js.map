{"version":3,"file":"wtf-plugin-markdown.js","sources":["../src/01-doc.js","../src/02-section.js","../src/03-paragraph.js","../src/_lib/smartReplace.js","../src/04-sentence.js","../src/05-link.js","../src/image.js","../src/_lib/pad.js","../src/infobox.js","../src/list.js","../src/reference.js","../src/table.js","../src/index.js"],"sourcesContent":["const defaults = {\n  redirects: true,\n  infoboxes: true,\n  templates: true,\n  sections: true\n}\n// we should try to make this look like the wikipedia does, i guess.\nconst softRedirect = function(doc) {\n  let link = doc.redirectTo()\n  let href = link.page\n  href = './' + href.replace(/ /g, '_')\n  if (link.anchor) {\n    href += '#' + link.anchor\n  }\n  return `↳ [${link.text}](${href})`\n}\n\n//turn a Doc object into a markdown string\nconst toMarkdown = function(options) {\n  options = Object.assign({}, defaults, options)\n  let data = this.data\n  let md = ''\n  //if it's a redirect page, give it a 'soft landing':\n  if (options.redirects === true && this.isRedirect() === true) {\n    return softRedirect(this) //end it here\n  }\n  //render infoboxes (up at the top)\n  if (options.infoboxes === true && options.templates === true) {\n    md += this.infoboxes()\n      .map(infobox => infobox.markdown(options))\n      .join('\\n\\n')\n  }\n  //render each section\n  if (options.sections === true || options.paragraphs === true || options.sentences === true) {\n    md += data.sections.map(s => s.markdown(options)).join('\\n\\n')\n  }\n  //default false\n  if (options.references === true) {\n    md += '## References'\n    md += this.citations()\n      .map(c => c.json(options))\n      .join('\\n')\n  }\n  return md\n}\nmodule.exports = toMarkdown\n","const defaults = {\n  headers: true,\n  images: true,\n  tables: true,\n  lists: true,\n  paragraphs: true\n}\n\nconst doSection = function(options) {\n  options = Object.assign({}, defaults, options)\n  let md = ''\n  //make the header\n  if (options.headers === true && this.title()) {\n    let header = '##'\n    for (let i = 0; i < this.depth; i += 1) {\n      header += '#'\n    }\n    md += header + ' ' + this.title() + '\\n'\n  }\n  //put any images under the header\n  if (options.images === true) {\n    let images = this.images()\n    if (images.length > 0) {\n      md += images.map(img => img.markdown()).join('\\n')\n      md += '\\n'\n    }\n  }\n  //make a mardown table\n  if (options.tables === true) {\n    let tables = this.tables()\n    if (tables.length > 0) {\n      md += '\\n'\n      md += tables.map(table => table.markdown(options)).join('\\n')\n      md += '\\n'\n    }\n  }\n  //make a mardown bullet-list\n  if (options.lists === true) {\n    let lists = this.lists()\n    if (lists.length > 0) {\n      md += lists.map(list => list.markdown(options)).join('\\n')\n      md += '\\n'\n    }\n  }\n  //finally, write the sentence text.\n  if (options.paragraphs === true || options.sentences === true) {\n    md += this.paragraphs()\n      .map(p => {\n        return p\n          .sentences()\n          .map(s => s.markdown(options))\n          .join(' ')\n      })\n      .join('\\n\\n')\n  }\n  return md\n}\nmodule.exports = doSection\n","const defaults = {\n  sentences: true\n}\n\nconst toMarkdown = function(options) {\n  options = Object.assign({}, defaults, options)\n  let md = ''\n  if (options.sentences === true) {\n    md += this.sentences().reduce((str, s) => {\n      str += s.markdown(options) + '\\n'\n      return str\n    }, {})\n  }\n  return md\n}\nmodule.exports = toMarkdown\n","//escape a string like 'fun*2.Co' for a regExpr\nfunction escapeRegExp(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&')\n}\n\n//sometimes text-replacements can be ambiguous - words used multiple times..\nconst smartReplace = function(all, text, result) {\n  if (!text || !all) {\n    return all\n  }\n\n  if (typeof all === 'number') {\n    all = String(all)\n  }\n  text = escapeRegExp(text)\n  //try a word-boundary replace\n  let reg = new RegExp('\\\\b' + text + '\\\\b')\n  if (reg.test(all) === true) {\n    all = all.replace(reg, result)\n  } else {\n    //otherwise, fall-back to a much messier, dangerous replacement\n    // console.warn('missing \\'' + text + '\\'');\n    all = all.replace(text, result)\n  }\n  return all\n}\n\nmodule.exports = smartReplace\n","const smartReplace = require('./_lib/smartReplace')\n\nconst defaults = {\n  links: true,\n  formatting: true\n}\n\n//create links, bold, italic in markdown\nconst toMarkdown = function(options) {\n  options = Object.assign({}, defaults, options)\n  let md = this.text()\n  //turn links back into links\n  if (options.links === true) {\n    this.links().forEach(link => {\n      let mdLink = link.markdown()\n      let str = link.text() || link.page()\n      md = smartReplace(md, str, mdLink)\n    })\n  }\n  //turn bolds into **bold**\n  if (options.formatting === true) {\n    this.bold().forEach(b => {\n      md = smartReplace(md, b, '**' + b + '**')\n    })\n    //support *italics*\n    this.italic().forEach(i => {\n      md = smartReplace(md, i, '*' + i + '*')\n    })\n  }\n  return md\n}\nmodule.exports = toMarkdown\n","// add `[text](href)` to the text\nconst toMarkdown = function() {\n  let href = this.href()\n  href = href.replace(/ /g, '_')\n  // href = encodeURIComponent(href)\n  let str = this.text() || this.page()\n  return '[' + str + '](' + href + ')'\n}\nmodule.exports = toMarkdown\n","//markdown images are like this: ![alt text](href)\nconst toMarkdown = function() {\n  let alt = this.data.file.replace(/^(file|image):/i, '')\n  alt = alt.replace(/\\.(jpg|jpeg|png|gif|svg)/i, '')\n  return '![' + alt + '](' + this.thumbnail() + ')'\n}\nmodule.exports = toMarkdown\n","//center-pad each cell, to make the table more legible\nconst pad = (str, cellWidth) => {\n  str = str || ''\n  str = String(str)\n  cellWidth = cellWidth || 15\n  let diff = cellWidth - str.length\n  diff = Math.ceil(diff / 2)\n  for (let i = 0; i < diff; i += 1) {\n    str = ' ' + str\n    if (str.length < cellWidth) {\n      str = str + ' '\n    }\n  }\n  return str\n}\nmodule.exports = pad\n","const dontDo = {\n  image: true,\n  caption: true,\n  alt: true,\n  signature: true,\n  'signature alt': true\n}\n\nconst defaults = {\n  images: true\n}\n\n//\nconst pad = require('./_lib/pad')\n\n// render an infobox as a table with two columns, key + value\nconst doInfobox = function(options) {\n  options = Object.assign({}, defaults, options)\n  let md = '|' + pad('', 35) + '|' + pad('', 30) + '|\\n'\n  md += '|' + pad('---', 35) + '|' + pad('---', 30) + '|\\n'\n  //todo: render top image here (somehow)\n  Object.keys(this.data).forEach(k => {\n    if (dontDo[k] === true) {\n      return\n    }\n    let key = '**' + k + '**'\n    let s = this.data[k]\n    let val = s.markdown(options)\n    //markdown is more newline-sensitive than wiki\n    val = val.split(/\\n/g).join(', ')\n    md += '|' + pad(key, 35) + '|' + pad(val, 30) + ' |\\n'\n  })\n  return md\n}\nmodule.exports = doInfobox\n","//\nconst toMarkdown = function(options) {\n  return this.lines()\n    .map(s => {\n      let str = s.markdown(options)\n      return ' * ' + str\n    })\n    .join('\\n')\n}\nmodule.exports = toMarkdown\n","//\nconst toMarkdown = function() {\n  if (this.data && this.data.url && this.data.title) {\n    return `⌃ [${this.data.title}](${this.data.url})`\n  } else if (this.data.encyclopedia) {\n    return `⌃ ${this.data.encyclopedia}`\n  } else if (this.data.title) {\n    //cite book, etc\n    let str = this.data.title\n    if (this.data.author) {\n      str += this.data.author\n    }\n    if (this.data.first && this.data.last) {\n      str += this.data.first + ' ' + this.data.last\n    }\n    return `⌃ ${str}`\n  } else if (this.inline) {\n    return `⌃ ${this.inline.markdown()}`\n  }\n  return ''\n}\nmodule.exports = toMarkdown\n","const pad = require('./_lib/pad')\n/* this is a markdown table:\n| Tables        | Are           | Cool  |\n| ------------- |:-------------:| -----:|\n| col 3 is      | right-aligned | $1600 |\n| col 2 is      | centered      |   $12 |\n| zebra stripes | are neat      |    $1 |\n*/\n\nconst makeRow = (arr) => {\n  arr = arr.map((s) => pad(s, 14))\n  return '| ' + arr.join(' | ') + ' |'\n}\n\n//markdown tables are weird\nconst doTable = function (options) {\n  let md = ''\n  if (!this || this.length === 0) {\n    return md\n  }\n  let rows = this.data\n  let keys = Object.keys(rows[0])\n  //first, grab the headers\n  //remove auto-generated number keys\n  let headers = keys.map((k) => {\n    if (/^col[0-9]/.test(k) === true) {\n      return ''\n    }\n    return k\n  })\n  //draw the header (necessary!)\n  md += makeRow(headers) + '\\n'\n  md += makeRow(headers.map(() => '---')) + '\\n'\n  //do each row..\n  md += rows\n    .map((row) => {\n      //each column..\n      let arr = keys.map((k) => {\n        if (!row[k]) {\n          return ''\n        }\n        return row[k].markdown(options) || ''\n      })\n      //make it a nice padded row\n      return makeRow(arr)\n    })\n    .join('\\n')\n  return md + '\\n'\n}\nmodule.exports = doTable\n","const doc = require('./01-doc')\nconst section = require('./02-section')\nconst paragraph = require('./03-paragraph')\nconst sentence = require('./04-sentence')\nconst link = require('./05-link')\nconst image = require('./image')\nconst infobox = require('./infobox')\nconst list = require('./list')\nconst reference = require('./reference')\nconst table = require('./table')\n\nconst plugin = function(models) {\n  models.Doc.prototype.markdown = doc\n  models.Section.prototype.markdown = section\n  models.Paragraph.prototype.markdown = paragraph\n  models.Sentence.prototype.markdown = sentence\n  models.Link.prototype.markdown = link\n  models.Image.prototype.markdown = image\n  models.Infobox.prototype.markdown = infobox\n  models.Table.prototype.markdown = table\n  models.List.prototype.markdown = list\n  models.Reference.prototype.markdown = reference\n}\nmodule.exports = plugin\n"],"names":["defaults","redirects","infoboxes","templates","sections","softRedirect","doc","link","redirectTo","href","page","replace","anchor","text","toMarkdown","options","Object","assign","data","md","isRedirect","map","infobox","markdown","join","paragraphs","sentences","s","references","citations","c","json","headers","images","tables","lists","doSection","title","header","i","depth","length","img","table","list","p","reduce","str","escapeRegExp","smartReplace","all","result","String","reg","RegExp","test","links","formatting","forEach","mdLink","bold","b","italic","alt","file","thumbnail","pad","cellWidth","diff","Math","ceil","dontDo","image","caption","signature","doInfobox","keys","k","key","val","split","lines","url","encyclopedia","author","first","last","inline","makeRow","arr","doTable","rows","row","plugin","models","Doc","prototype","Section","section","Paragraph","paragraph","Sentence","sentence","Link","Image","Infobox","Table","List","Reference","reference"],"mappings":"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"}