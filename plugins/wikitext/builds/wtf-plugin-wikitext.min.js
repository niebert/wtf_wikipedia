!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).wtfWikitext=n()}(this,(function(){"use strict";var t={images:!0,tables:!0,infoboxes:!0,categories:!0,lists:!0,links:!0,paragraphs:!0},n=function(n){n=n||{},n=Object.assign({},t,n);var i="";if(!0===this.isRedirect())return"#REDIRECT [[".concat(this.redirectTo().page,"]]");if(!0===n.infoboxes&&(i+=this.infoboxes().map((function(t){return t.wikitext(n)})).join("\n")),!0===n.sections||!0===n.paragraphs||!0===n.sentences){var e=this.sections();i+=e.map((function(t){return t.wikitext(n)})).join("\n")}return!0===n.categories&&(i+="\n",this.categories().forEach((function(t){return i+="\n[[Category: ".concat(t,"]]")}))),i},i={},e=function(t){t=t||{},t=Object.assign({},i,t);var n="";if(this.title()){n+="\n".concat("=="," ").concat(this.title()," ").concat("==","\n")}return this.templates().forEach((function(t){var i,e,o;n+=(e="",o=(i=t).template,Object.keys(i).forEach((function(t){"template"!==t&&(e+=" | ".concat(t," = ").concat(i[t]))})),"{{".concat(o).concat(e,"}} ")+"\n")})),!0===t.tables&&(n+=this.tables().map((function(n){return n.wikitext(t)})).join("\n")),!0===t.lists&&(n+=this.lists().map((function(n){return n.text(t)})).join("\n")),n+=this.paragraphs().map((function(n){return n.wikitext(t)})).join("\n"),this.references().forEach((function(i){n+=i.wikitext(t)+"\n"})),n},o={},c=function(t){t=t||{},t=Object.assign({},o,t);var n="";return this.images().forEach((function(t){n+=t.wikitext()})),this.lists().forEach((function(t){n+=t.wikitext()})),n+=this.sentences().map((function(n){return n.wikitext(t)})).join("\n")};var a=function(t,n,i){if(!n||!t)return t;"number"==typeof t&&(t=String(t)),n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var e=new RegExp("\\b"+n+"\\b");return t=!0===e.test(t)?t.replace(e,i):t.replace(n,i)},r={links:!0},s=function(t){t=t||{},t=Object.assign({},r,t);var n=this.text();return!0===t.links&&this.links().forEach((function(t){var i=t.text()||t.page(),e=t.wikitext();n=a(n,i,e)})),!0===t.formatting&&(this.bold().forEach((function(t){n=a(n,t,"**"+t+"**")})),this.italic().forEach((function(t){n=a(n,t,"***"+t+"***")}))),n},f=function(){if(this.site())return this.text()?"[".concat(this.site(),"|").concat(this.text(),"]"):"[".concat(this.site(),"]");var t=this.page()||"";this.anchor()&&(t+="#".concat(this.anchor()));var n=this.text()||"";return n&&n.toLowerCase()!==t.toLowerCase()?"[[".concat(t,"|").concat(n,"]]"):"[[".concat(t,"]]")},u=function(){var t="[[".concat(this.file(),"|thumb");return this.data.caption&&(t+="|".concat(this.data.caption.wikitext())),t+"]]"},h=function(){var t=this,n="{{Infobox ".concat(this._type||"","\n");return Object.keys(this.data).forEach((function(i){var e=t.data[i];e&&(n+="| ".concat(i," = ").concat(e.wikitext()||"","\n"))})),n+="}}\n"},p=function(){var t="";return this.lines().forEach((function(n){t+="* ".concat(n.wikitext(),"\n")})),t},x=function(){var t=this;if(this.data.inline)return"<ref>".concat(this.data.inline.wikitext(),"</ref>");var n=this.data.type||"cite web",i="";return Object.keys(this.data).forEach((function(n){"template"!==n&&"type"!==n&&(i+=" | ".concat(n," = ").concat(t.data[n]))})),"<ref>{{".concat(n).concat(i,"}}</ref>")},k=function(t){var n=this.data,i='{| class="wikitable"\n',e=Object.keys(n[0]);return(e=e.filter((function(t){return!0!==/^col[0-9]/.test(t)}))).length>0&&(i+="|-\n",e.forEach((function(t){i+="! "+t+"\n"}))),n.forEach((function(n){i+="|-\n",Object.keys(n).forEach((function(e){var o=n[e].wikitext(t);i+="| "+o+"\n"}))})),i+="|}"};return function(t){t.Doc.prototype.wikitext=n,t.Section.prototype.wikitext=e,t.Paragraph.prototype.wikitext=c,t.Sentence.prototype.wikitext=s,t.Link.prototype.wikitext=f,t.Image.prototype.wikitext=u,t.Infobox.prototype.wikitext=h,t.Table.prototype.wikitext=k,t.List.prototype.wikitext=p,t.Reference.prototype.wikitext=x}}));
